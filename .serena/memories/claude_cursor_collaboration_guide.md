# Claude Code 與 Cursor 協作指南

## 協作架構概覽
```
Claude Code (策略規劃) ←→ Serena Memory (狀態同步) ←→ Cursor (具體執行)
```

## 角色分工

### Claude Code 職責
- **策略規劃**: 分析需求、制定執行計畫
- **記憶管理**: 更新 Serena 記憶體中的工作指引
- **品質監控**: 檢視 Cursor 產出，提供改進建議
- **流程控制**: 根據工作紀錄決定下一步驟

### Cursor 職責  
- **程式碼執行**: 根據 Serena 中的指引進行具體開發
- **檔案產出**: 建立、修改檔案到指定目標路徑
- **狀態更新**: 及時更新工作紀錄中的執行狀態
- **問題回報**: 遇到技術問題時向 Claude Code 回報

### Serena Memory 職責
- **指引儲存**: 保存 Claude Code 制定的工作步驟
- **狀態同步**: 維護最新的工作紀錄
- **知識庫**: 提供專案相關的參考資訊

## 協作流程

### 階段一：需求分析與規劃
1. **Claude Code**: 分析用戶需求
2. **Claude Code**: 制定詳細執行計畫
3. **Claude Code**: 將計畫寫入 Serena Memory
4. **Claude Code**: 建立工作紀錄檔案

### 階段二：任務執行
1. **Cursor**: 讀取 Serena 中的工作指引
2. **Cursor**: 執行具體的開發任務
3. **Cursor**: 產出檔案到目標路徑
4. **Cursor**: 更新工作紀錄狀態

### 階段三：品質檢核
1. **Claude Code**: 檢視工作紀錄中的完成項目
2. **Claude Code**: 驗證 Cursor 的產出品質
3. **Human**: 進行關鍵節點的 double confirm
4. **Claude Code**: 根據結果規劃下一步驟

## 關鍵檔案結構

### 工作紀錄檔案 (work_log.md)
```markdown
# 工作紀錄

## 當前任務
- 任務ID: TASK-001
- 任務描述: [具體描述]
- 負責者: Cursor
- 狀態: in_progress

## 執行進度
- [x] 步驟1: 已完成
- [ ] 步驟2: 進行中
- [ ] 步驟3: 待執行

## 產出檔案
- `/path/to/file1.md` - 已建立
- `/path/to/file2.js` - 待建立

## 檢核點
- [ ] 程式碼品質檢查
- [ ] 功能測試驗證
- [ ] 人工確認通過
```

### 工作指引檔案 (current_work_instructions.md)
```markdown
# 當前工作指引

## 任務概述
[Claude Code 提供的詳細任務說明]

## 執行步驟
1. [具體步驟1]
2. [具體步驟2]
3. [具體步驟3]

## 技術要求
- 使用的技術棧
- 程式碼風格要求
- 檔案命名慣例

## 產出要求
- 目標檔案路徑
- 檔案內容規格
- 品質標準
```

## 品質保證機制

### 自動檢核
- Cursor 執行後的基本語法檢查
- 檔案結構完整性驗證
- 命名慣例遵循檢查

### 人工確認點
- 關鍵功能模組完成後
- 重要配置檔案修改後  
- 專案里程碑達成後
- 最終交付前

## 溝通協定

### 狀態更新格式
```
[時間] [執行者] [狀態] [描述]
2024-06-27 14:30 Cursor COMPLETED 建立基礎模組檔案
2024-06-27 14:35 Claude REVIEWED 品質檢核通過，進行下一步
```

### 問題回報格式
```
問題類型: [技術/需求/其他]
問題描述: [具體描述]
影響範圍: [檔案/功能]
建議解決方案: [如有的話]
```

## 協作最佳實務

1. **及時同步**: 每完成一個步驟都要更新狀態
2. **清晰溝通**: 使用標準化的狀態和格式
3. **品質優先**: 不急於求成，確保每個產出都符合標準
4. **記錄完整**: 詳細記錄執行過程和遇到的問題
5. **持續改進**: 根據協作經驗不斷優化流程